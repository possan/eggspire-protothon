<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="bower_components/jquery/jquery.js"></script>
	<script type="text/javascript" src="bower_components/momentjs/moment.js"></script>
	<link rel="stylesheet" href="style.css" />
</head>
<body>

	<header>
		<div class="inner">
			<div class="logo">
				<h1><a href="index.html">Eggspire</a></h1>
			</div>
			<div class="menu">
				<a href="index.html">Search</a>
				|
				<a href="me.html">Me</a>
				|
				<a href="share.html">Share</a>
			</div>
			<div class="search">
				<input id="q" value="" placeholder="Find free food" /></input>
			</div>
		</div>
	</header>

	<section class="main">
		<section class="content">
			<div class="searchresults">
				<h2 id="searchresultstitle">Search results</h2>
				<h2 id="recenttitle">Recent additions</h2>
				<ul id="results">
				</ul>
			</div>
		</section>
		<aside>
			<a class="motivation" href="share.html">
				<h3>Have excess food?</h3>
				Give it away!
			</a>
			<div class="motivation">
				<h3>Why?</h3>
				670000 tonnes<br/>
				72kg/person/yr<br/>
				121818 elephants<br/>
				<br/>
			</div>
		</aside>
	</section>

	<footer>
		<div class="inner">
			Eggspire
		</div>
	</footer>

	<script type="text/javascript">

		var alldata = [
			{ title: 'Tomatoes', image: 'tomato.png' },
			{ title: 'Eggs', image: 'eggs.png' },
			{ title: 'Bread', image: 'bread.png' }
		]

		function doSearch(q) {
			console.log('doSearch', q);
			var total = 40;
			if (q == '') {
				$('#searchresultstitle').hide();
				$('#recenttitle').show();
			} else {
				$('#searchresultstitle').show();
				$('#recenttitle').hide();
				total = Math.floor(5 + Math.random() * 5);
			}
			var html = '';
			for(var i=0; i<total; i++) {
				var n = Math.floor(Math.random() * alldata.length);
				var data = alldata[n];
				data.qty = Math.floor(1 + Math.random() * 3);
				data.distance = Math.floor(150 + Math.random() * 3000);
				data.expires = Math.floor(2 + Math.random() * 5);
				html += '<li><a href="reserve.html#'+encodeURIComponent(JSON.stringify(data,0,null))+'">';
				html += '<span class="image"><img src="' + data.image + '" /></span>';
				html += '<span class="info">';
				html += '<h4>'+data.title+'</h4>';
				html += '<span class="qty">Quantity: '+data.qty+'</span>';
				html += '<span class="distance">'+data.distance+' Meters</span>';
				html += '</span>';
				html += '</a></li>';
			}
			html += '<li class="clear"></li>';
			$('ul#results').html(html);
		}

		var q = $('input#q');
		if (q.length > 0) {
			q.change(function(e) {
				doSearch(q.val());
			});
			q.keyup(function(e) {
				doSearch(q.val());
			});
		}

		doSearch('');

	</script>
</body>
</html>